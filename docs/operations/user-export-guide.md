# 用户数据导出使用说明

## 概述

我已经为您创建了用户数据导出工具，可以从平台数据库中导出所有注册用户的信息。

## 当前导出结果

✅ **成功导出 59 个用户**

### 用户统计
- **总用户数**: 59
- **已验证邮箱**: 58
- **未验证邮箱**: 1

### 注册方式分布
- local: 59 (所有用户都通过本地注册)

### 角色分布
- USER: 58
- ADMIN: 1

## 导出的数据字段

每个用户记录包含以下信息：
- **ID**: 用户唯一标识
- **姓名**: 用户姓名
- **用户名**: 用户名
- **邮箱**: 注册邮箱
- **邮箱已验证**: 是/否
- **注册方式**: 注册提供商（local/google/facebook等）
- **角色**: 用户角色（USER/ADMIN）
- **创建时间**: 账户创建时间
- **更新时间**: 最后更新时间
- **已接受条款**: 是/否
- **双因素认证**: 是否启用2FA

## 使用方法

### 1. 导出用户数据为JSON格式

```bash
./scripts/export-users.sh
```

这个脚本会：
- 连接到MongoDB数据库
- 导出所有用户数据到 `exports/users_YYYYMMDD_HHMMSS.json`
- 显示用户统计信息

### 2. 转换JSON为CSV格式

```bash
./scripts/convert-to-csv.sh
```

这个脚本会：
- 查找最新的JSON导出文件
- 转换为CSV格式，保存到同名的 `.csv` 文件
- CSV文件包含UTF-8 BOM，可以直接在Excel中打开

### 3. 转换指定的JSON文件

```bash
./scripts/convert-to-csv.sh exports/users_20260209_231719.json
```

## 导出文件位置

所有导出的文件保存在：
```
/opt/librechat-radio/exports/
```

当前已导出的文件：
- `users_20260209_231719.json` - JSON格式，22KB
- `users_20260209_231719.csv` - CSV格式，便于在Excel中查看

## 数据安全注意事项

⚠️ **重要提醒**：

1. 导出的数据包含用户的个人信息（邮箱、姓名等），请妥善保管
2. 不要将这些文件提交到版本控制系统（已添加到 `.gitignore`）
3. 用户的密码已被排除，不会出现在导出数据中
4. 如需分享数据，请确保已获得适当的授权并采取必要的脱敏措施

## 技术实现

### export-users.sh
- 使用 `docker exec` 直接访问MongoDB容器
- 通过 `mongosh` 命令行工具查询数据
- 输出JSON格式，包含用户统计信息

### convert-to-csv.sh
- 使用Node.js读取JSON文件
- 转换为CSV格式，带UTF-8 BOM
- 支持在Excel中正确显示中文

### export-users.js (备用方案)
- 使用mongoose直接连接数据库
- 独立的Node.js脚本
- 当前因容器网络配置暂不可用，但代码已准备好

## 后续使用建议

如果您需要：
1. **定期导出**: 可以将脚本添加到cron任务中定期执行
2. **筛选数据**: 可以修改MongoDB查询条件，只导出特定条件的用户
3. **其他格式**: 可以基于JSON数据生成Excel、PDF等其他格式

有任何问题或需要修改导出格式，请随时告诉我！
